<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Minimum Distance to Mean ¬∑ PosDefManifoldML</title><meta name="title" content="Minimum Distance to Mean ¬∑ PosDefManifoldML"/><meta property="og:title" content="Minimum Distance to Mean ¬∑ PosDefManifoldML"/><meta property="twitter:title" content="Minimum Distance to Mean ¬∑ PosDefManifoldML"/><meta name="description" content="Documentation for PosDefManifoldML."/><meta property="og:description" content="Documentation for PosDefManifoldML."/><meta property="twitter:description" content="Documentation for PosDefManifoldML."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img src="../assets/logo.png" alt="PosDefManifoldML logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../">PosDefManifoldML</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">PosDefManifoldML Documentation</a></li><li><a class="tocitem" href="../tutorial/">Tutorial</a></li><li><a class="tocitem" href="../MainModule/">Main Module</a></li><li><a class="tocitem" href="../tools/">Tools</a></li><li><span class="tocitem">ML Models: PD Manifold</span><ul><li class="is-active"><a class="tocitem" href>Minimum Distance to Mean</a></li></ul></li><li><span class="tocitem">ML Models: PD Tangent Space</span><ul><li><a class="tocitem" href="../enlr/">Elastic-Net Logistic Regression</a></li><li><a class="tocitem" href="../svm/">Support-Vector Machine</a></li></ul></li><li><a class="tocitem" href="../cv/">Fit, Predict, CV</a></li><li><span class="tocitem">Statistics</span><ul><li><a class="tocitem" href="../stats_descriptive/">Descriptive</a></li><li><a class="tocitem" href="../stats_inferential/">Inferential</a></li></ul></li><li><a class="tocitem" href="../conditioners/">Conditioners &amp; Pipelines</a></li><li><a class="tocitem" href="../contribute/">How to contribute</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">ML Models: PD Manifold</a></li><li class="is-active"><a href>Minimum Distance to Mean</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Minimum Distance to Mean</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="..." title="View the repository"><span class="docs-icon fa-brands">Ô°Å</span><span class="docs-label is-hidden-touch">Repository</span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="mdm.jl"><a class="docs-heading-anchor" href="#mdm.jl">mdm.jl</a><a id="mdm.jl-1"></a><a class="docs-heading-anchor-permalink" href="#mdm.jl" title="Permalink"></a></h1><p>This unit implements the Riemannian <strong>MDM (Minimum Distance to Mean)</strong> classifier for the manifold of positive definite (PD) matrices, both real (symmetric PD) or complex (Hermitian PD) matrices. The MDM is a <em>simple</em>, yet <em>efficient</em>, <em>deterministic</em> and <em>paramater-free</em> classifier acting directly on the manifold of positive definite matrices (Barachat el <em>al.</em>, 2012; Congedo et <em>al.</em>, 2017a <a href="../">üéì</a>): given a number of PD matrices representing <em>class means</em>, the MDM classify an unknown datum (also a PD matrix) as belonging to the class whose mean is the closest to the datum. The process is illustrated in the upper part of this <a href="https://raw.githubusercontent.com/Marco-Congedo/PosDefManifoldML.jl/master/docs/src/assets/Fig1.jpg">figure</a>.</p><p>The MDM classifier involves only the concepts of a <em>distance function</em> for two PD matrices and a <em>mean</em> (center of mass or barycenter) for a number of them. Those are defined for any given metric, a <a href="https://marco-congedo.github.io/PosDefManifold.jl/dev/MainModule/#Metric::Enumerated-type-1">Metric</a> enumerated type declared in <a href="https://marco-congedo.github.io/PosDefManifold.jl/dev/">PosDefManifold</a>.</p><p>Currently supported metrics are:</p><table><tr><th style="text-align: left">metric (distance)</th><th style="text-align: left">mean estimation</th><th style="text-align: left">known also as</th></tr><tr><td style="text-align: left">Euclidean</td><td style="text-align: left">arithmetic</td><td style="text-align: left">Arithmetic</td></tr><tr><td style="text-align: left">invEuclidean</td><td style="text-align: left">harmonic</td><td style="text-align: left"></td></tr><tr><td style="text-align: left">ChoEuclidean</td><td style="text-align: left">Cholesky Euclidean</td><td style="text-align: left"></td></tr><tr><td style="text-align: left">logEuclidean</td><td style="text-align: left">log-Euclidean</td><td style="text-align: left"></td></tr><tr><td style="text-align: left">logCholesky</td><td style="text-align: left">log-Cholesky</td><td style="text-align: left"></td></tr><tr><td style="text-align: left">Fisher</td><td style="text-align: left">Fisher</td><td style="text-align: left">Cartan, Karcher, Pusz-Woronowicz, Affine-Invariant, ...</td></tr><tr><td style="text-align: left">logdet0</td><td style="text-align: left">logDet</td><td style="text-align: left">S, Œ±, Bhattacharyya, Jensen, ...</td></tr><tr><td style="text-align: left">Jeffrey</td><td style="text-align: left">Jeffrey</td><td style="text-align: left">symmetrized Kullback-Leibler</td></tr><tr><td style="text-align: left">Wasserstein</td><td style="text-align: left">Wasserstein</td><td style="text-align: left">Bures, Hellinger, optimal transport, ...</td></tr></table><p>Do not use the Von Neumann metric, which is also supported in <em>PosDefManifold</em>, since it does not allow a definition of mean. See <a href="https://marco-congedo.github.io/PosDefManifold.jl/dev/introToRiemannianGeometry/">here</a> for details on the metrics. In order to use these metrics you need to install the <em>PosDefManifold</em> package.</p><p>The <strong>fit</strong>, <strong>predict</strong> and <strong>crval</strong> functions for the MDM model are reported in the <a href="../cv/#cv.jl">cv.jl</a> unit, since those are homogeneous across all machine learning models. Here it is reported the <a href="#PosDefManifoldML.MDMmodel"><code>MDMmodel</code></a> abstract type, the <a href="#PosDefManifoldML.MDM"><code>MDM</code></a> structure and the following functions, which typically you will not need to access directly, but are nonetheless provided to facilitate low-level operations with MDM classifiers:</p><table><tr><th style="text-align: left">function</th><th style="text-align: left">description</th></tr><tr><td style="text-align: left"><a href="#PosDefManifoldML.barycenter"><code>barycenter</code></a></td><td style="text-align: left">compute the barycenter of positive definite matrices for fitting the MDM model</td></tr><tr><td style="text-align: left"><a href="#PosDefManifoldML.distances"><code>distances</code></a></td><td style="text-align: left">compute the distances of a matrix set to a set of means</td></tr></table><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PosDefManifoldML.MDMmodel" href="#PosDefManifoldML.MDMmodel"><code>PosDefManifoldML.MDMmodel</code></a> ‚Äî <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Abstract type for MDM (Minimum Distance to Mean) machine learning models</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PosDefManifoldML.MDM" href="#PosDefManifoldML.MDM"><code>PosDefManifoldML.MDM</code></a> ‚Äî <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mutable struct MDM &lt;: MDMmodel
    metric  :: Metric = Fisher;
    pipeline :: Pipeline
    featDim :: Int
    means   :: ‚ÑçVector
    imeans  :: ‚ÑçVector
end</code></pre><p>MDM machine learning models are incapsulated in this mutable structure. MDM models have four fields: <code>.metric</code>, <code>.pipeline</code>, <code>.featDim</code> and <code>.means</code>.</p><p>The field <code>metric</code>, of type <a href="https://marco-congedo.github.io/PosDefManifold.jl/dev/MainModule/#Metric::Enumerated-type-1">Metric</a>, is to be specified by the user. It is the metric that will be adopted to compute the class means and the distances to the mean.</p><p>All other fields do not correspond to arguments passed upon creation of the model by the default creator. Instead, they are filled later when a model is created by the <a href="../cv/#StatsAPI.fit"><code>fit</code></a> function:</p><p>The field <code>pipeline</code>, of type <a href="../conditioners/#PosDefManifoldML.Pipeline"><code>Pipeline</code></a>, holds an optional sequence of data pre-conditioners to be applied to the data.  The pipeline is learnt when a ML model is fitted - see <a href="../cv/#StatsAPI.fit"><code>fit</code></a> -  and stored in the model. If the pipeline is fitted, it is  automatically applied to the data at each call of the <a href="../cv/#StatsAPI.predict"><code>predict</code></a> function.</p><p>The field <code>featDim</code> is the dimension of the manifold in which the model acts. This is given by <em>n(n+1)/2</em>, where <em>n</em> is the dimension of the PD matrices. This field is not to be specified by the user, instead, it is computed when the MDM model is fit using the <a href="../cv/#StatsAPI.fit"><code>fit</code></a> function and is accessible only thereafter.</p><p>The field <code>means</code> is an <a href="https://marco-congedo.github.io/PosDefManifold.jl/dev/MainModule/#%E2%84%8DVector-type-1">‚ÑçVector</a> holding the class means, <em>i.e.</em>, one mean for each class. This field is not to be specified by the user, instead, the means are computed when the MDM model is fitted using the <a href="../cv/#StatsAPI.fit"><code>fit</code></a> function and are accessible only thereafter.</p><p>The field <code>imeans</code> is an ‚ÑçVector holding the inverse of the matrices in <code>means</code>. This also is not to be specified by the user, is computed when the model is fitted and is accessible only thereafter. It is used to optimize the computation of distances if the model is fitted useing the Fisher metric (default).</p><p><strong>Examples</strong>:</p><pre><code class="language-julia hljs">using PosDefManifoldML, PosDefManifold

# Create an empty model
m = MDM(Fisher)

# Since the Fisher metric is the default metric,
# this is equivalent to
m = MDM()</code></pre><p>Note that in general you need to invoke these constructors only when an empty MDM model is needed as an argument to a function, otherwise you can more simply create and fit an MDM model using the <a href="../cv/#StatsAPI.fit"><code>fit</code></a> function.</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PosDefManifoldML.barycenter" href="#PosDefManifoldML.barycenter"><code>PosDefManifoldML.barycenter</code></a> ‚Äî <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">function barycenter(metric :: Metric, ùêè:: ‚ÑçVector;
              w        :: Vector = [],
              ‚úìw       :: Bool    = true,
              meanInit :: Union{‚Ñç, Nothing} = nothing,
              tol      :: Real   = 0.,
              ‚è©      :: Bool    = true)</code></pre><p>Typically, you will not need this function as it is called by the <a href="../cv/#StatsAPI.fit"><code>fit</code></a> function.</p><p>Given a <code>metric</code> of type <a href="https://marco-congedo.github.io/PosDefManifold.jl/dev/MainModule/#Metric::Enumerated-type-1">Metric</a>, an <a href="https://marco-congedo.github.io/PosDefManifold.jl/dev/MainModule/#%E2%84%8DVector-type-1">‚ÑçVector</a> of Hermitian matrices <span>$ùêè$</span> and an optional non-negative real weights vector <code>w</code>, return the (weighted) mean of the matrices in <span>$ùêè$</span>. This is used to fit MDM models.</p><p>This function calls the appropriate mean functions of package <a href="https://marco-congedo.github.io/PosDefManifold.jl/dev/">PostDefManifold</a>, depending on the chosen <code>metric</code>, and check that, if the mean is found by an iterative algorithm, then the iterative algorithm converges.</p><p>See method (3) of the <a href="https://marco-congedo.github.io/PosDefManifold.jl/dev/riemannianGeometry/#Statistics.mean">mean</a> function for the meaning of the optional keyword arguments <code>w</code>, <code>‚úìw</code>, <code>meanInit</code>, <code>tol</code> and <code>‚è©</code>, to which they are passed.</p><p>The returned mean is flagged by Julia as an Hermitian matrix (see <a href="https://docs.julialang.org/en/v1/stdlib/LinearAlgebra/">LinearAlgebra</a>).</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PosDefManifoldML.distances" href="#PosDefManifoldML.distances"><code>PosDefManifoldML.distances</code></a> ‚Äî <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">function distances(metric :: Metric,
                      means  :: ‚ÑçVector,
                      ùêè      :: ‚ÑçVector;
                imeans  :: Union{‚ÑçVector, Nothing} = nothing,
                scale   :: Bool = false,
                ‚è©      :: Bool = true)</code></pre><p>Typically, you will not need this function as it is called by the <a href="../cv/#StatsAPI.predict"><code>predict</code></a> function.</p><p>Given an <a href="https://marco-congedo.github.io/PosDefManifold.jl/dev/MainModule/#%E2%84%8DVector-type-1">‚ÑçVector</a> <span>$ùêè$</span> holding <em>k</em> Hermitian matrices and an ‚ÑçVector <code>means</code> holding <em>z</em> matrix means, return the <em>square of the distance</em> of each matrix in <span>$ùêè$</span> to the means in <code>means</code>.</p><p>The squared distance is computed according to the chosen <code>metric</code>, of type <a href="https://marco-congedo.github.io/PosDefManifold.jl/dev/MainModule/#Metric::Enumerated-type-1">Metric</a>. See <a href="https://marco-congedo.github.io/PosDefManifold.jl/dev/introToRiemannianGeometry/#metrics-1">metrics</a> for details on the supported distance functions.</p><p>The computation of distances is optimized for the Fisher metric if an ‚ÑçVector holding the inverse of the means in <code>means</code> is passed as optional keyword argument <code>imeans</code>. For other metrics this argument is ignored.</p><p>If <code>scale</code> is true (default), the distances are divided by the size of the matrices in <span>$ùêè$</span>. This can be useful to compare distances computed on manifolds with different dimensions. It has no effect here, but is used as it is good practice.</p><p>If <code>‚è©</code> is true, the distances are computed using multi-threading, unless the number of threads Julia is instructed to use is &lt;2 or &lt;3k.</p><p>The result is a <em>z</em>x<em>k</em> matrix of squared distances.</p></div></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../tools/">¬´ Tools</a><a class="docs-footer-nextpage" href="../enlr/">Elastic-Net Logistic Regression ¬ª</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.11.4 on <span class="colophon-date" title="Thursday 12 June 2025 15:00">Thursday 12 June 2025</span>. Using Julia version 1.11.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
